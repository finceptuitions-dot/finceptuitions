<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign Up - Finceptuitions</title>
<meta name="theme-color" content="#2575fc">

<style>
body {
    font-family: Arial, sans-serif;
    background:#f5f7fa;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
}
.signup-container {
    background:white;
    padding:30px 40px;
    border-radius:12px;
    box-shadow:0 2px 10px rgba(0,0,0,0.2);
    width:100%;
    max-width:400px;
}
.signup-container h2 {
    text-align:center;
    color:#1e3a8a;
}
.signup-container form {
    display:flex;
    flex-direction:column;
}
.signup-container label {
    margin-top:15px;
    margin-bottom:5px;
    color:#1e3a8a;
    font-weight:bold;
}
.signup-container input {
    padding:10px;
    border-radius:8px;
    border:1px solid #ccc;
}
.password-box {
    position:relative;
}
.password-box span {
    position:absolute;
    right:12px;
    top:50%;
    transform:translateY(-50%);
    cursor:pointer;
}
.signup-container button {
    margin-top:20px;
    padding:12px;
    background:#1e3a8a;
    color:white;
    font-weight:bold;
    border:none;
    border-radius:8px;
    cursor:pointer;
}
.signup-container p {
    text-align:center;
    margin-top:15px;
}
.signup-container a {
    color:#1e3a8a;
    font-weight:bold;
    text-decoration:none;
}
</style>
</head>
<body>

<div class="signup-container">
    <h2>Create Account</h2>

    <form id="signup-form">
        <label>Full Name</label>
        <input type="text" id="name" required>

        <label>Email</label>
        <input type="email" id="email" required>

        <label>Password</label>
        <div class="password-box">
            <input type="password" id="password" required>
            <span onclick="togglePassword()">üëÅ</span>
        </div>

        <label>WhatsApp Number</label>
        <input type="tel" id="whatsapp" placeholder="+260XXXXXXXXX" required>

        <button type="submit">Sign Up</button>
    </form>

    <p>Already have an account? <a href="login.html">Login</a></p>
</div>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
var firebaseConfig = {
  apiKey: "AIzaSyCBFObaNdHuPDVM3eo-1qtJ0ENQ3vf1oOc",
  authDomain: "finceponlinetuitions.firebaseapp.com",
  projectId: "finceponlinetuitions",
  storageBucket: "finceponlinetuitions.appspot.com",
  messagingSenderId: "562071475466",
  appId: "1:562071475466:web:1823cb7c22b64729dd16f3"
};

firebase.initializeApp(firebaseConfig);
var auth = firebase.auth();
var db = firebase.firestore();

function togglePassword(){
    var input = document.getElementById("password");
    input.type = input.type === "password" ? "text" : "password";
}

document.getElementById("signup-form").addEventListener("submit", function(e){
    e.preventDefault();

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const whatsapp = document.getElementById("whatsapp").value.trim();

    auth.createUserWithEmailAndPassword(email, password)
    .then(function(cred){

        // ‚úÖ SAVE USER TO FIRESTORE FIRST
        return db.collection("users").doc(cred.user.uid).set({
            name: name,
            email: email,
            whatsapp: whatsapp,

            disabled: false,

            memberSince: firebase.firestore.FieldValue.serverTimestamp(),
            trialStart: firebase.firestore.FieldValue.serverTimestamp(),
            trialDays: 7,          // default trial
            progress: 0,           // progress starts at 0%

            role: "student"
        });
    })
    .then(function(){
        alert("Account created successfully!");
        window.location.replace("dashboard.html");
    })
    .catch(function(error){
        alert(error.message);
    });
});
</script>

</body>
</html>