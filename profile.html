<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile - Learn With Enock Academy</title>
<link rel="stylesheet" href="style.css">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2575fc">
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f5f7fa;
    margin: 0;
    color: #1e3a8a;
}
header {
    background-color: #1e3a8a;
    color: white;
    text-align: center;
    padding: 20px 0;
}
.container {
    max-width: 600px;
    margin: 20px auto;
    padding: 0 15px;
}
.section {
    background-color: white;
    margin-bottom: 20px;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.section h2 {
    margin-top: 0;
}
.back-btn {
    margin: 10px 0;
    padding: 8px 15px;
    background: #1e3a8a; 
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}
.back-btn:hover {
    background-color: #334155;
}
</style>
</head>
<body>

<header>
    <h1>User Profile</h1>
</header>

<div class="container">
    <button onclick="history.back()" class="back-btn">‚Üê Back</button>

    <div class="section">
        <h2>Personal Information</h2>
        <p><strong>Name:</strong> <span id="profile-name">Loading...</span></p>
        <p><strong>Email:</strong> <span id="profile-email">Loading...</span></p>
        <p><strong>Member since:</strong> <span id="profile-since">Loading...</span></p>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC6gaEIKoeZmSRwVVJOrkQtk7SW_iiqz04",
  authDomain: "secondary-school-center.firebaseapp.com",
  projectId: "secondary-school-center",
  storageBucket: "secondary-school-center.firebasestorage.app",
  messagingSenderId: "156434969933",
  appId: "1:156434969933:web:796b926798647d1ada3304",
  measurementId: "G-G70CP4W5F8"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user)=>{
    if(!user) location.href = 'login.html';

    const docRef = doc(db, 'users', user.uid);
    const docSnap = await getDoc(docRef);

    if(docSnap.exists()){
        const data = docSnap.data();
        document.getElementById('profile-name').textContent = data.name;
        document.getElementById('profile-email').textContent = data.email;
        document.getElementById('profile-since').textContent = data.memberSince || 'Unknown';
    } else {
        alert('User data not found.');
        auth.signOut();
        location.href = 'login.html';
    }
});
</script>
<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js")
    .then(() => console.log("Service Worker registered"))
    .catch((err) => console.log("SW registration failed:", err));
}
</script>


</body>
</html>
