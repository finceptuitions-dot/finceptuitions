<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enock Academy Dashboard</title>
<meta name="theme-color" content="#0B3D91">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body { margin:0; font-family: Arial, sans-serif; background-color: #f0f8ff; }
.dashboard-header { display:flex; flex-direction:column; align-items:center; text-align:center; background:#0B3D91; color:white; padding:15px 10px; box-shadow:0 2px 6px rgba(0,0,0,0.2); border-bottom-left-radius:10px; border-bottom-right-radius:10px; position:relative; z-index:500; }
.dashboard-header h2 { margin:0; }
.welcome-msg { font-size:1.1em; font-weight:bold; margin-top:3px; }
#trial-days { font-size:0.9em; margin-top:3px; opacity:0.85; }

/* Header buttons */
.header-top-left, .header-top-right { position:absolute; top:10px; }
.header-top-left { left:15px; }
.header-top-right { right:15px; }
.header-top-left button, .header-top-right button { background:none; border:none; color:white; font-size:24px; cursor:pointer; }

/* Overlay */
.hamburger-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.4); z-index:390; display:none; }
/* Menu */
.hamburger-menu { position:fixed; top:0; left:0; width:200px; height:100%; background:#0B3D91; padding:20px; z-index:400; border-right:2px solid #87CEFA; transform:translateX(-100%); transition: transform 0.3s ease; overflow-y:auto; }
.hamburger-menu.active { transform:translateX(0); }
.hamburger-menu ul { list-style:none; padding:0; }
.hamburger-menu li { margin:15px 0; }
.hamburger-menu a { color:#87CEFA; text-decoration:none; font-weight:bold; display:flex; align-items:center; gap:8px; }
.hamburger-menu a:hover { color:white; }

/* Main Cards */
.dashboard-main { padding:25px 15px; }
.nav-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:18px; max-width:420px; margin:auto; }
.nav-card { background:white; border-radius:12px; padding:25px 10px; text-align:center; font-weight:bold; color:#0B3D91; box-shadow:0 3px 8px rgba(0,0,0,0.15); cursor:pointer; transition:transform 0.2s, background 0.2s; }
.nav-card:hover { transform:translateY(-4px); background:#e6f2ff; }
.nav-card span { display:block; margin-top:8px; font-size:0.9em; }
.nav-card i { font-size:32px; }

/* WhatsApp Floating Button */
.whatsapp-float { position:fixed; bottom:20px; right:20px; width:48px; height:48px; background-color:#25D366; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 10px rgba(0,0,0,0.3); z-index:1000; transition:transform 0.2s ease, background 0.2s ease; }
.whatsapp-float:hover { transform:scale(1.1); background-color:#1ebe5d; }
.whatsapp-float svg { width:24px; height:24px; fill:white; }
</style>
</head>

<body>

<div id="hamburger-overlay" class="hamburger-overlay"></div>

<header class="dashboard-header">
    <div class="header-top-left">
        <button id="menu-btn"><i class="fas fa-bars"></i></button>
    </div>
    <div class="header-top-right">
        <button id="logout-btn"><i class="fas fa-sign-out-alt"></i></button>
    </div>
    <h2>Fincep Tuitions</h2>
    <p id="trial-days">Loading trial days...</p>
    <p class="welcome-msg">Welcome!</p>
    <nav id="hamburger-menu" class="hamburger-menu">
        <div style="text-align:center; margin-bottom:20px;">
            <img src="fincep.jpg" alt="Logo" style="width:100px; border-radius:50%;">
            <p id="hamburger-username" style="color:white; font-weight:bold; margin-top:8px;"></p>
        </div>
        <ul>
            <li><a href="profile.html"><i class="fas fa-user"></i> Profile</a></li>
            <li><a href="task.html"><i class="fas fa-tasks"></i> Tasks</a></li>
            <li><a href="calculator.html"><i class="fas fa-calculator"></i> Calculator</a></li>
            <li><a href="about.html"><i class="fas fa-info-circle"></i> About Us</a></li>
            <li><a href="admin.html"><i class="fas fa-user-shield"></i> Admin</a></li>
        </ul>
    </nav>
</header>

<main class="dashboard-main">
    <div class="nav-grid">
        <div class="nav-card" onclick="location.href='videos.html'">
            <i class="fas fa-video"></i><span>Videos</span>
        </div>
        <div class="nav-card" onclick="location.href='documents.html'">
            <i class="fas fa-file-alt"></i><span>Documents</span>
        </div>
        <div class="nav-card" onclick="location.href='pastpapers.html'">
            <i class="fas fa-book"></i><span>Past Papers</span>
        </div>
        <div class="nav-card" onclick="location.href='task.html'">
            <i class="fas fa-tasks"></i><span>Assignments</span>
        </div>
    </div>
</main>

<div style="text-align:center; padding:15px;">
    <a href="syllabus.html">
        <button style="background-color:#0B3D91;color:white;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-weight:bold;font-size:0.9em;">
            Subscribe
        </button>
    </a>
</div>

<a href="https://chat.whatsapp.com/HL0hEWhZkyrBl3jihvCy9w" class="whatsapp-float" target="_blank" aria-label="Join WhatsApp Group">
    <svg viewBox="0 0 32 32" aria-hidden="true">
        <path d="M16 0C7.164 0 0 6.94 0 15.5c0 2.73.73 5.41 2.11 7.77L0 32l9.07-2.38A16.33 16.33 0 0 0 16 31c8.836 0 16-6.94 16-15.5S24.836 0 16 0zm0 28.18c-2.47 0-4.89-.63-7.03-1.83l-.5-.29-5.38 1.41 1.44-5.12-.33-.52A12.62 12.62 0 0 1 3.82 15.5C3.82 8.95 9.32 3.82 16 3.82s12.18 5.13 12.18 11.68S22.68 28.18 16 28.18zm6.6-9.09c-.36-.18-2.14-1.04-2.47-1.16-.33-.12-.58-.18-.83.18-.25.36-.96 1.16-1.18 1.4-.22.24-.44.27-.8.09-.36-.18-1.53-.55-2.91-1.76-1.07-.93-1.79-2.08-2-2.44-.21-.36-.02-.56.16-.74.16-.16.36-.41.54-.61.18-.2.24-.34.36-.57.12-.24.06-.45-.03-.63-.09-.18-.83-1.98-1.14-2.71-.3-.72-.61-.62-.83-.63h-.71c-.24 0-.63.09-.96.45-.33.36-1.26 1.23-1.26 3 0 1.77 1.29 3.48 1.47 3.72.18.24 2.54 3.87 6.16 5.43.86.36 1.53.58 2.05.74.86.27 1.65.23 2.27.14.69-.1 2.14-.86 2.44-1.69.3-.83.3-1.54.21-1.69-.09-.15-.33-.24-.69-.42z"/>
    </svg>
</a>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
var firebaseConfig = {
  apiKey: "AIzaSyCBFObaNdHuPDVM3eo-1qtJ0ENQ3vf1oOc",
  authDomain: "finceponlinetuitions.firebaseapp.com",
  projectId: "finceponlinetuitions",
  storageBucket: "finceponlinetuitions.appspot.com",
  messagingSenderId: "562071475466",
  appId: "1:562071475466:web:1823cb7c22b64729dd16f3"
};
firebase.initializeApp(firebaseConfig);
var auth = firebase.auth();
var db = firebase.firestore();

// Hamburger Menu
const menuBtn = document.getElementById('menu-btn');
const menu = document.getElementById('hamburger-menu');
const overlay = document.getElementById('hamburger-overlay');
menuBtn.onclick = ()=>{ menu.classList.toggle('active'); overlay.style.display = menu.classList.contains('active')?'block':'none'; };
overlay.onclick = ()=>{ menu.classList.remove('active'); overlay.style.display='none'; };

// Logout
document.getElementById('logout-btn').onclick = ()=>{ auth.signOut().then(()=> window.location.replace("login.html")); };

// Auth state
auth.onAuthStateChanged(function(user){
    if(user){
        const userRef = db.collection("users").doc(user.uid);
        userRef.onSnapshot(function(doc){
            if(doc.exists){
                const data = doc.data();
                document.querySelector('.welcome-msg').textContent = `Welcome, ${data.name}!`;
                document.getElementById('hamburger-username').textContent = data.name;

                // Start trial countdown
                startTrialCountdown(data.trialStart || data.createdAt, data.trialDays || 3, user.uid);
            }
        });
    } else {
        window.location.replace("login.html");
    }
});

// Countdown
let countdownInterval;
function startTrialCountdown(trialStart, trialDays, uid){
    clearInterval(countdownInterval);
    const startDate = trialStart.seconds ? new Date(trialStart.seconds*1000) : new Date(trialStart);
    countdownInterval = setInterval(()=>{
        const now = new Date();
        const endTime = new Date(startDate.getTime() + trialDays*24*60*60*1000);
        const diff = endTime - now;
        if(diff <= 0){
            clearInterval(countdownInterval);
            document.getElementById('trial-days').textContent = "Trial expired!";
            alert("Your trial has expired! Logging out...");
            auth.signOut().then(()=> window.location.replace("login.html"));
            return;
        }
        const days = Math.floor(diff/(1000*60*60*24));
        const hours = Math.floor((diff%(1000*60*60*24))/(1000*60*60));
        const minutes = Math.floor((diff%(1000*60*60))/(1000*60));
        const seconds = Math.floor((diff%(1000*60))/1000);
        document.getElementById('trial-days').textContent = `Trial remaining: ${days}d ${hours}h ${minutes}m ${seconds}s`;
    }, 1000);
}
</script>
</body>
</html>